package stelling.model;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

/**
 * Repræsenterer en forespørgsel på et sæt af opgaver
 */
public class Forespoergsel implements IBeskrivelig {
	private final Session session;
	private final List<Opgave> opgaver;

	/**
	 * Kreerer ny forespørgsel med en default opgave
	 */
	Forespoergsel(Session inSession) {
		opgaver = new ArrayList<Opgave>();
		session = inSession;
		nyOpgave(session.defaultOpgaveType());
	}

	/**
	 * Returnerer de understøttede opgavetyper sorteret efter navn
	 * 
	 * @return Opgavetyper sorteret efter navn
	 */
	public List<OpgaveType> opgaveTyper() {
		return session.opgaveTyper();
	}

	/**
	 * Returnerer de eksisterende opgaver i denne forespørgsel
	 * 
	 * @return Eksisterende opgaver
	 */
	public List<Opgave> opgaver() {
		return Collections.unmodifiableList(opgaver);
	}

	@Override
	public String beskriv() {
		return beskriv("");
	}

	@Override
	public String beskriv(String linjePrefix) {
		StringBuilder builder = new StringBuilder();
		builder.append(linjePrefix).append(
				"Forespørgsel med følgende opgaver:\n");
		for (Opgave opgave : opgaver) {
			builder.append(opgave.beskriv(linjePrefix + "\t"));
		}
		return builder.toString();
	}

	/**
	 * Tilføjer en ny opgave til forespørgslen af den specificerede type
	 * 
	 * @param opgaveType
	 *            Type af den nye opgave
	 * @return Ny opgave af den specificerede type
	 */
	public Opgave nyOpgave(OpgaveType opgaveType) {
		Opgave opgave = opgaveType.nyOpgave();
		opgaver.add(opgave);
		return opgave;
	}
}
